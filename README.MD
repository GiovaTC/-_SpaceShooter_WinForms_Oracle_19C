# üöÄ SpaceShooter WinForms + Oracle 19c

Juego en **WinForms (Visual Studio 2022)** con registro de puntaje en **Oracle 19c**.

Este proyecto muestra c√≥mo crear un juego sencillo de **nave espacial en C#** que:
- Tiene **interfaz gr√°fica (WinForms)**  
- Controla la nave con el teclado  
- Mantiene **puntaje** y **colisiones**  
- Guarda el **puntaje + fecha/hora** en una **base de datos Oracle 19c**

---

## üß© Requisitos

- **Visual Studio 2022** (Workload: `.NET desktop development`)  
- **.NET 6 o .NET 7 (WinForms)** ‚Äî el ejemplo apunta a `net6.0-windows`  
- **Oracle 19c** (local o remoto)  
- Usuario con permisos para `INSERT`  
- Paquete NuGet: [`Oracle.ManagedDataAccess.Core`](https://www.nuget.org/packages/Oracle.ManagedDataAccess.Core)

---

## üóÑÔ∏è Esquema de Base de Datos (Oracle 19c)

Ejecute en su instancia Oracle (SQL*Plus o SQL Developer):

```sql
CREATE TABLE game_scores (
    id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    player VARCHAR2(100),
    score NUMBER,
    played_at TIMESTAMP DEFAULT SYSTIMESTAMP
);
```

**(Opcional) Crear usuario dedicado:**
```sql
CREATE USER game_user IDENTIFIED BY StrongPassword;
GRANT CONNECT, RESOURCE TO game_user;
```

Ajuste el nombre de usuario, contrase√±a y `Data Source` en la cadena de conexi√≥n.

---

## üß± Estructura del Proyecto

```
SpaceShooter/
‚îú‚îÄ SpaceShooter.sln
‚îú‚îÄ SpaceShooter/ (proyecto WinForms)
‚îÇ  ‚îú‚îÄ Program.cs
‚îÇ  ‚îú‚îÄ MainForm.cs
‚îÇ  ‚îú‚îÄ DataAccess.cs
‚îÇ  ‚îú‚îÄ appsettings.json (opcional)
‚îÇ  ‚îî‚îÄ Resources/ (sprites opcionales)
```

---

## üîå Cadena de Conexi√≥n (Oracle)

**Ejemplo EZCONNECT**
```text
User Id=GAME_USER;Password=StrongPassword;Data Source=localhost:1521/ORCLPDB1;
```

**Ejemplo con servicio (tnsnames):**
```text
User Id=GAME_USER;Password=StrongPassword;
Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=your-host)(PORT=1521))
(CONNECT_DATA=(SERVICE_NAME=ORCLPDB1)));
```

---

## üíæ C√≥digo Completo

### Program.cs
```csharp
using System;
using System.Windows.Forms;

namespace SpaceShooter
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.SetHighDpiMode(HighDpiMode.SystemAware);
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new MainForm());
        }
    }
}
```

---

### DataAccess.cs
```csharp
using System;
using Oracle.ManagedDataAccess.Client;

namespace SpaceShooter
{
    public static class DataAccess
    {
        // Cambie esta cadena por la suya
        private const string ConnectionString =
            "User Id=GAME_USER;Password=StrongPassword;Data Source=localhost:1521/ORCLPDB1;";

        public static void SaveScore(string player, int score)
        {
            using var conn = new OracleConnection(ConnectionString);
            conn.Open();

            using var cmd = conn.CreateCommand();
            cmd.CommandText = "INSERT INTO game_scores (player, score, played_at) VALUES (:p_player, :p_score, SYSTIMESTAMP)";
            cmd.Parameters.Add(new OracleParameter("p_player", player));
            cmd.Parameters.Add(new OracleParameter("p_score", score));

            cmd.ExecuteNonQuery();
        }
    }
}
```

> üí° **Nota:** Instale el paquete NuGet  
> `Install-Package Oracle.ManagedDataAccess.Core`

---

### MainForm.cs (fragmento principal)
```csharp
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;

namespace SpaceShooter
{
    public partial class MainForm : Form
    {
        private Rectangle player;
        private List<Rectangle> asteroids = new();
        private Random rnd = new();
        private int score = 0;
        private bool gameOver = false;
        private Timer gameTimer = new();
        private Label lblScore = new();
        private Button btnSave = new();
        private int spawnCounter = 0;

        public MainForm()
        {
            InitializeComponent();
            this.DoubleBuffered = true;
            this.Width = 400;
            this.Height = 600;
            this.Text = "Space Shooter";

            player = new Rectangle(this.ClientSize.Width / 2 - 20, this.ClientSize.Height - 60, 40, 40);

            lblScore.Text = "Score: 0";
            lblScore.ForeColor = Color.White;
            lblScore.Dock = DockStyle.Top;
            lblScore.TextAlign = ContentAlignment.MiddleCenter;
            this.Controls.Add(lblScore);

            btnSave.Text = "Guardar Puntaje";
            btnSave.Dock = DockStyle.Bottom;
            btnSave.Enabled = false;
            btnSave.Click += BtnSave_Click;
            this.Controls.Add(btnSave);

            this.KeyDown += MainForm_KeyDown;
            this.Paint += MainForm_Paint;

            gameTimer.Interval = 30;
            gameTimer.Tick += GameLoop;
            gameTimer.Start();
        }

        private void BtnSave_Click(object? sender, EventArgs e)
        {
            string playerName = Microsoft.VisualBasic.Interaction.InputBox("Nombre del jugador:", "Guardar puntaje", "Jugador1");
            DataAccess.SaveScore(playerName, score);
            MessageBox.Show("Puntaje guardado correctamente en Oracle.");
        }

        private void MainForm_KeyDown(object? sender, KeyEventArgs e)
        {
            if (gameOver) return;
            int move = 10;
            if (e.KeyCode == Keys.Left && player.X > 0) player.X -= move;
            if (e.KeyCode == Keys.Right && player.X < this.ClientSize.Width - player.Width) player.X += move;
        }

        private void GameLoop(object? sender, EventArgs e)
        {
            spawnCounter++;
            if (spawnCounter >= 20)
            {
                spawnCounter = 0;
                int w = rnd.Next(20, 50);
                int x = rnd.Next(0, this.ClientSize.Width - w);
                asteroids.Add(new Rectangle(x, -w, w, w));
            }

            for (int i = asteroids.Count - 1; i >= 0; i--)
            {
                var r = asteroids[i];
                r.Y += 6 + (score / 50);
                asteroids[i] = r;

                if (r.IntersectsWith(player))
                {
                    GameOver();
                    return;
                }

                if (r.Y > this.ClientSize.Height)
                {
                    asteroids.RemoveAt(i);
                    score += 10;
                    lblScore.Text = "Score: " + score;
                }
            }

            if (Environment.TickCount % 50 == 0)
            {
                score += 1;
                lblScore.Text = "Score: " + score;
            }

            Invalidate();
        }

        private void GameOver()
        {
            gameOver = true;
            gameTimer.Stop();
            btnSave.Enabled = true;
            MessageBox.Show(this, "Game Over! Puntaje: " + score, "Fin", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        private void MainForm_Paint(object? sender, PaintEventArgs e)
        {
            var g = e.Graphics;

            using (var b = new SolidBrush(Color.Black))
                g.FillRectangle(b, this.ClientRectangle);

            Point[] triangle = new Point[] {
                new Point(player.X + player.Width / 2, player.Y),
                new Point(player.X, player.Y + player.Height),
                new Point(player.X + player.Width, player.Y + player.Height)
            };
            g.FillPolygon(Brushes.Cyan, triangle);

            foreach (var a in asteroids)
                g.FillEllipse(Brushes.Gray, a);

            if (gameOver)
            {
                var msg = "GAME OVER";
                var f = new Font("Segoe UI", 28, FontStyle.Bold);
                var size = g.MeasureString(msg, f);
                g.DrawString(msg, f, Brushes.Red,
                    (ClientSize.Width - size.Width) / 2,
                    (ClientSize.Height - size.Height) / 2);
            }
        }
    }
}
```

---

## ‚ñ∂Ô∏è Ejecuci√≥n del Proyecto

1. Abra **Visual Studio 2022**  
2. Cree un nuevo proyecto **WinForms App (.NET 6 o superior)**  
3. Reemplace el contenido con los archivos mostrados arriba  
4. Instale el paquete:
   ```
   Install-Package Oracle.ManagedDataAccess.Core
   ```
5. Ajuste la cadena de conexi√≥n en `DataAccess.cs`  
6. Ejecute el proyecto (`F5`)  
7. Juegue, obtenga puntaje y presione ‚ÄúGuardar Puntaje‚Äù al finalizar üéØ

---

## üåü Mejoras sugeridas

- A√±adir **sprites** personalizados y sonido  
- Implementar **ranking global** desde Oracle  
- Guardar m√°s estad√≠sticas: tiempo jugado, precisi√≥n, nivel, etc.  
- Adaptar para **WPF** o **.NET MAUI**

---

## üìÇ Nombre del Proyecto

**`SpaceShooter-WinForms-Oracle19c`**

Proyecto ejemplo completo en **Visual Studio 2022** que cumple:
- Interfaz gr√°fica
- Jugabilidad b√°sica
- Puntaje y registro del puntaje + hora en **Oracle 19c**

---

![Logo](https://github.com/giovaTC.png)

¬© 2025 GiovaTC ‚Äî Proyecto educativo para aprendizaje de WinForms y Oracle .NET integraci√≥n.
